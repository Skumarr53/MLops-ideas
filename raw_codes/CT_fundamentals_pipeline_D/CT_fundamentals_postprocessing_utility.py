# Databricks notebook source
# MAGIC %md
# MAGIC # CALL TRANSCRIPT RELEVANCE SCORES GENERATOR SCRIPT 
# MAGIC   
# MAGIC PRIMARY AUTHOR : Bea Yu (primary author of classes composing NLP methods, other classes called in this processing and "glue code")
# MAGIC
# MAGIC SECONDARY AUTHORS: Partha Kadmbi (primary author of most NLP methods)
# MAGIC
# MAGIC DATE : 04.03.2023
# MAGIC
# MAGIC CONTEXT DESCRIPTION : First notebook in the call transcript NLP processing pipeline to execute ETL from Snowflake nonproduction databases
# MAGIC
# MAGIC CONTEXT NOTEBOOKS :
# MAGIC
# MAGIC - "topicx_model.py" including classes to generate topicx scores.
# MAGIC - "dataframe_utility.py" including classes to generate the spark dataframe with spark data types from pandas dataframe.
# MAGIC - "snowflake_dbutility.py" including classes to interact with the snowflake database.
# MAGIC - "logging.py" including classes for custom logging.
# MAGIC - After then notebook has executed:
# MAGIC
# MAGIC   - Run CT_fundamentals_preprocessor_utility.py to generate the FILT values and saved in AJAY_CTS_PREPROCESSED_D table in snowflake.
# MAGIC   - Run CT_fundamentals_TOPICX_utility.py and CT_fundamentals_FINBERT_Scores_Utility.py to generate the topicx and FINBERT scores.
# MAGIC         And saves in topicx scores in AJAY_CTS_TOPICX_SCORES_D table and finbert scores in AJAY_CTS_FINBERT_SCORES_D table of snowflake
# MAGIC   - Run CT_fundamentals_sentiment_scores_utility.py to generate the relevance scores and saved in AJAY_CTS_COMBINED_SCORES_D table in snowflake
# MAGIC
# MAGIC
# MAGIC CONTACT INFO : bea.yu@voya.com, partha.kadambi@voya.com, ajaya.devalla@voya.com

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/algorithms/topicx_model

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/algorithms/statistics

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/postprocessor/dataframe_transform_utility

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/dfutils/dataframe_utils

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/database/snowflake_dbutility

# COMMAND ----------

# MAGIC %run ./../../data-science-nlp-ml-common-code/impackage/dfutils/spark_df_utils

# COMMAND ----------

import pandas as pd
import numpy as np
from datetime import timedelta

# COMMAND ----------

# DBTITLE 1,Read SnowFlake Credentials.
# Object to enable Snowflake access to prod Quant
myDBFS = DBFSUtility()
new_sf =  pd.read_pickle(r'/dbfs' + myDBFS.INIpath +config.snowflake_cred_pkl_file)

# COMMAND ----------

# DBTITLE 1,Read inbert data
# Read the last set of parsed transcripts that were run in the fundamentals workflow. Get the (latest) parsed datetime from the set.
try:
  finbert_currdf = pd.read_parquet(config.CT_FINBERT_parquet_file)
  finbert_currdf.head(3)
except Exception as ex:
  raise ex

# COMMAND ----------

print(len(finbert_currdf))

# COMMAND ----------

# DBTITLE 1,Read Topicx Data
# Read the last set of parsed transcripts that were run in the fundamentals workflow. Get the (latest) parsed datetime from the set.
try:
  topicx_currdf =  pd.read_parquet(config.CT_TOPICX_parquet_file)
  topicx_currdf.head(3)
except Exception as ex:
  raise ex

# COMMAND ----------

print(len(topicx_currdf))

# COMMAND ----------

# DBTITLE 1,Verify if size of finbert and topicx data is same.
if (len(finbert_currdf)>0 and len(topicx_currdf)>0) and len(finbert_currdf)==len(topicx_currdf):
    print('The data spans from ' + str(topicx_currdf['PARSED_DATETIME_EASTERN_TZ'].min()) + ' to ' + str(topicx_currdf['PARSED_DATETIME_EASTERN_TZ'].max()) + 'and has ' + str(topicx_currdf.shape[0]) + ' rows and ' + str(topicx_currdf.shape[1]) + ' columns.')
else:
    CT_sentiment_file = open(config.CT_sentiment_parquet_file, "wb")
    CT_sentiment_file.close()
    topicx_currdf.to_parquet(config.CT_sentiment_parquet_file,engine = 'pyarrow', compression = 'gzip')
    raise Exception('No new transcripts to parse.')

# COMMAND ----------

# DBTITLE 1,Merge TopicX and Finbert Data based on Columns
final_df = pd.merge(left=topicx_currdf, right=finbert_currdf[config.CTS_FINBERT_specific_scores_columns], left_on=['ENTITY_ID','VERSION_ID','UPLOAD_DT_UTC'], right_on=['ENTITY_ID','VERSION_ID','UPLOAD_DT_UTC'])

# COMMAND ----------

print(len(final_df))

# COMMAND ----------

# DBTITLE 1,Read Business related words and labels.
# Read match list and create match set
try:
  match_df = pd.read_csv(config.CT_fundamentals_path)
except Exception as ex:
  raise ex

# COMMAND ----------

# DBTITLE 1,Create TopicX Object
topicx_obj=TopicXModel()

# COMMAND ----------

# DBTITLE 1,Create Word_set _dict containing unigrams and bigrams.
word_set_dict = {topic.upper() : topicx_obj.get_match_set(match_df[match_df['label']==topic]['word'].values) for topic in match_df['label'].unique()}

# COMMAND ----------

# DBTITLE 1,Load FILT_sections (FILT_MD, FILT_QA etc)
filt_sections_list=config.FILT_sections

# COMMAND ----------

# DBTITLE 1,Create DFUtils object and convert column to list.
df_utils=DFUtils()
currdf=df_utils.df_column_convert_to_list(final_df,filt_sections_list)

# COMMAND ----------

# DBTITLE 1,Create Object fo Statistics and DFTransformUtility
stats_obj=Statistics()
df_transform_utility=DFTransformUtility()

# COMMAND ----------

# DBTITLE 1,Calculate scores based on Filt_sections
for label in config.FILT_sections:
    final_df['SENT_SCORES_' + label]=final_df['SENT_SCORES_' + label].apply(lambda x: x.tolist())
    final_df['SENT_LABELS_' + label]=final_df['SENT_LABELS_' + label].apply(lambda x: x.tolist())
    final_df['LEN_' + label]=final_df['LEN_' + label].apply(lambda x: x.tolist())
    final_df['RAW_LEN_' + label]=final_df['RAW_LEN_' + label].apply(lambda x: x.tolist())
    for topic in word_set_dict.keys():
        final_df[topic + '_TOTAL_' + label] = final_df[topic + '_TOTAL_' + label].apply(lambda x: x.tolist())
        final_df[topic+ '_STATS_' + label]=final_df[topic+ '_STATS_' + label].apply(lambda stats_dict:df_transform_utility.filter_stats_dictionary(stats_dict))
        final_df[topic + '_STATS_LIST_' + label] = final_df[topic + '_STATS_LIST_' + label].apply(lambda x: x.tolist())

# COMMAND ----------

final_df.head(2)

# COMMAND ----------

# DBTITLE 1,Generate Sentence Relevance scores.
final_df=topicx_obj.generate_sentence_relevance_score(final_df,word_set_dict)


# COMMAND ----------

# DBTITLE 1,Convert to Float Type
for label in config.FILT_sections:
      for topic in word_set_dict.keys():
        final_df[topic + '_NET_SENT_' + label] = final_df[topic + '_NET_SENT_' + label].astype(float) 

# COMMAND ----------

final_df.head(2)

# COMMAND ----------

spark_parsedDF=df_transform_utility.preprocess_spark_df(final_df,config.CTS_combined_scores_columns)

# COMMAND ----------

# DBTITLE 1,Convert columns to Dateime.
spark_df_utils_obj=SparkDFUtils() 
spark_parsedDF=spark_df_utils_obj.convert_column_to_date_timestamp_type(spark_parsedDF,"PARSED_DATETIME_EASTERN_TZ",'yyyy-MM-dd HH mm ss')
spark_parsedDF=spark_df_utils_obj.convert_column_to_date_timestamp_type(spark_parsedDF,"EVENT_DATETIME_UTC",'yyyy-MM-dd HH mm ss')
spark_parsedDF=spark_df_utils_obj.convert_column_to_date_type(spark_parsedDF,"DATE",'yyyy-MM-dd')

# COMMAND ----------

# DBTITLE 1,Truncate and load combined scores daily table.
new_sf.db = config.eds_db_prod
new_sf.schema = config.schema
truncate_query="TRUNCATE TABLE {0}.{1}.{2}".format(config.eds_db_prod,config.schema,config.CT_sentiment_daily_table)
truncate_flag=new_sf.truncate_or_merge_table(truncate_query)
result_curr = new_sf.write_to_snowflake_table(spark_parsedDF, config.CT_sentiment_daily_table)

# COMMAND ----------

# DBTITLE 1,Merge Insert final data to combined scores historical table.
merge_query="""MERGE INTO {0}.{1} A 
  USING {2}.{3} B 
  ON A.ENTITY_ID = B.ENTITY_ID AND 
   A.VERSION_ID = B.VERSION_ID AND 
   A.UPLOAD_DT_UTC = B.UPLOAD_DT_UTC
  WHEN NOT MATCHED THEN 
     INSERT (ENTITY_ID,DATE,CALL_NAME,COMPANY_NAME,EARNINGS_CALL,ERROR,TRANSCRIPT_STATUS,CALL_ID,UPLOAD_DT_UTC,VERSION_ID,EVENT_DATETIME_UTC,PARSED_DATETIME_EASTERN_TZ,FILT_MD,FILT_QA,FILT_CEO_MD,FILT_CEO_QA,FILT_EXEC_MD,FILT_EXEC_QA,FILT_ANL_QA,SENT_SCORES_FILT_MD,SENT_LABELS_FILT_MD,SENT_SCORES_FILT_QA,SENT_LABELS_FILT_QA,SENT_SCORES_FILT_CEO_MD,SENT_LABELS_FILT_CEO_MD,SENT_SCORES_FILT_CEO_QA,SENT_LABELS_FILT_CEO_QA,SENT_SCORES_FILT_EXEC_MD,SENT_LABELS_FILT_EXEC_MD,SENT_SCORES_FILT_EXEC_QA,SENT_LABELS_FILT_EXEC_QA,SENT_SCORES_FILT_ANL_QA,SENT_LABELS_FILT_ANL_QA,LEN_FILT_MD,RAW_LEN_FILT_MD,REVENUE_TOTAL_FILT_MD,REVENUE_STATS_FILT_MD,REVENUE_STATS_LIST_FILT_MD,EARNINGS_TOTAL_FILT_MD,EARNINGS_STATS_FILT_MD,EARNINGS_STATS_LIST_FILT_MD,PROFITABILITY_TOTAL_FILT_MD,PROFITABILITY_STATS_FILT_MD,PROFITABILITY_STATS_LIST_FILT_MD,OPERATING_INCOME_TOTAL_FILT_MD,OPERATING_INCOME_STATS_FILT_MD,OPERATING_INCOME_STATS_LIST_FILT_MD,CASH_FLOWS_TOTAL_FILT_MD,CASH_FLOWS_STATS_FILT_MD,CASH_FLOWS_STATS_LIST_FILT_MD,SHAREHOLDER_RETURNS_TOTAL_FILT_MD,SHAREHOLDER_RETURNS_STATS_FILT_MD,SHAREHOLDER_RETURNS_STATS_LIST_FILT_MD,CAPITAL_USAGE_TOTAL_FILT_MD,CAPITAL_USAGE_STATS_FILT_MD,CAPITAL_USAGE_STATS_LIST_FILT_MD,GUIDANCE_TOTAL_FILT_MD,GUIDANCE_STATS_FILT_MD,GUIDANCE_STATS_LIST_FILT_MD,NUM_SENTS_FILT_MD,LEN_FILT_QA,RAW_LEN_FILT_QA,REVENUE_TOTAL_FILT_QA,REVENUE_STATS_FILT_QA,REVENUE_STATS_LIST_FILT_QA,EARNINGS_TOTAL_FILT_QA,EARNINGS_STATS_FILT_QA,EARNINGS_STATS_LIST_FILT_QA,PROFITABILITY_TOTAL_FILT_QA,PROFITABILITY_STATS_FILT_QA,PROFITABILITY_STATS_LIST_FILT_QA,OPERATING_INCOME_TOTAL_FILT_QA,OPERATING_INCOME_STATS_FILT_QA,OPERATING_INCOME_STATS_LIST_FILT_QA,CASH_FLOWS_TOTAL_FILT_QA,CASH_FLOWS_STATS_FILT_QA,CASH_FLOWS_STATS_LIST_FILT_QA,SHAREHOLDER_RETURNS_TOTAL_FILT_QA,SHAREHOLDER_RETURNS_STATS_FILT_QA,SHAREHOLDER_RETURNS_STATS_LIST_FILT_QA,CAPITAL_USAGE_TOTAL_FILT_QA,CAPITAL_USAGE_STATS_FILT_QA,CAPITAL_USAGE_STATS_LIST_FILT_QA,GUIDANCE_TOTAL_FILT_QA,GUIDANCE_STATS_FILT_QA,GUIDANCE_STATS_LIST_FILT_QA,NUM_SENTS_FILT_QA,LEN_FILT_CEO_MD,RAW_LEN_FILT_CEO_MD,REVENUE_TOTAL_FILT_CEO_MD,REVENUE_STATS_FILT_CEO_MD,REVENUE_STATS_LIST_FILT_CEO_MD,EARNINGS_TOTAL_FILT_CEO_MD,EARNINGS_STATS_FILT_CEO_MD,EARNINGS_STATS_LIST_FILT_CEO_MD,PROFITABILITY_TOTAL_FILT_CEO_MD,PROFITABILITY_STATS_FILT_CEO_MD,PROFITABILITY_STATS_LIST_FILT_CEO_MD,OPERATING_INCOME_TOTAL_FILT_CEO_MD,OPERATING_INCOME_STATS_FILT_CEO_MD,OPERATING_INCOME_STATS_LIST_FILT_CEO_MD,CASH_FLOWS_TOTAL_FILT_CEO_MD,CASH_FLOWS_STATS_FILT_CEO_MD,CASH_FLOWS_STATS_LIST_FILT_CEO_MD,SHAREHOLDER_RETURNS_TOTAL_FILT_CEO_MD,SHAREHOLDER_RETURNS_STATS_FILT_CEO_MD,SHAREHOLDER_RETURNS_STATS_LIST_FILT_CEO_MD,CAPITAL_USAGE_TOTAL_FILT_CEO_MD,CAPITAL_USAGE_STATS_FILT_CEO_MD,CAPITAL_USAGE_STATS_LIST_FILT_CEO_MD,GUIDANCE_TOTAL_FILT_CEO_MD,GUIDANCE_STATS_FILT_CEO_MD,GUIDANCE_STATS_LIST_FILT_CEO_MD,NUM_SENTS_FILT_CEO_MD,LEN_FILT_CEO_QA,RAW_LEN_FILT_CEO_QA,REVENUE_TOTAL_FILT_CEO_QA,REVENUE_STATS_FILT_CEO_QA,REVENUE_STATS_LIST_FILT_CEO_QA,EARNINGS_TOTAL_FILT_CEO_QA,EARNINGS_STATS_FILT_CEO_QA,EARNINGS_STATS_LIST_FILT_CEO_QA,PROFITABILITY_TOTAL_FILT_CEO_QA,PROFITABILITY_STATS_FILT_CEO_QA,PROFITABILITY_STATS_LIST_FILT_CEO_QA,OPERATING_INCOME_TOTAL_FILT_CEO_QA,OPERATING_INCOME_STATS_FILT_CEO_QA,OPERATING_INCOME_STATS_LIST_FILT_CEO_QA,CASH_FLOWS_TOTAL_FILT_CEO_QA,CASH_FLOWS_STATS_FILT_CEO_QA,CASH_FLOWS_STATS_LIST_FILT_CEO_QA,SHAREHOLDER_RETURNS_TOTAL_FILT_CEO_QA,SHAREHOLDER_RETURNS_STATS_FILT_CEO_QA,SHAREHOLDER_RETURNS_STATS_LIST_FILT_CEO_QA,CAPITAL_USAGE_TOTAL_FILT_CEO_QA,CAPITAL_USAGE_STATS_FILT_CEO_QA,CAPITAL_USAGE_STATS_LIST_FILT_CEO_QA,GUIDANCE_TOTAL_FILT_CEO_QA,GUIDANCE_STATS_FILT_CEO_QA,GUIDANCE_STATS_LIST_FILT_CEO_QA,NUM_SENTS_FILT_CEO_QA,LEN_FILT_EXEC_MD,RAW_LEN_FILT_EXEC_MD,REVENUE_TOTAL_FILT_EXEC_MD,REVENUE_STATS_FILT_EXEC_MD,REVENUE_STATS_LIST_FILT_EXEC_MD,EARNINGS_TOTAL_FILT_EXEC_MD,EARNINGS_STATS_FILT_EXEC_MD,EARNINGS_STATS_LIST_FILT_EXEC_MD,PROFITABILITY_TOTAL_FILT_EXEC_MD,PROFITABILITY_STATS_FILT_EXEC_MD,PROFITABILITY_STATS_LIST_FILT_EXEC_MD,OPERATING_INCOME_TOTAL_FILT_EXEC_MD,OPERATING_INCOME_STATS_FILT_EXEC_MD,OPERATING_INCOME_STATS_LIST_FILT_EXEC_MD,CASH_FLOWS_TOTAL_FILT_EXEC_MD,CASH_FLOWS_STATS_FILT_EXEC_MD,CASH_FLOWS_STATS_LIST_FILT_EXEC_MD,SHAREHOLDER_RETURNS_TOTAL_FILT_EXEC_MD,SHAREHOLDER_RETURNS_STATS_FILT_EXEC_MD,SHAREHOLDER_RETURNS_STATS_LIST_FILT_EXEC_MD,CAPITAL_USAGE_TOTAL_FILT_EXEC_MD,CAPITAL_USAGE_STATS_FILT_EXEC_MD,CAPITAL_USAGE_STATS_LIST_FILT_EXEC_MD,GUIDANCE_TOTAL_FILT_EXEC_MD,GUIDANCE_STATS_FILT_EXEC_MD,GUIDANCE_STATS_LIST_FILT_EXEC_MD,NUM_SENTS_FILT_EXEC_MD,LEN_FILT_EXEC_QA,RAW_LEN_FILT_EXEC_QA,REVENUE_TOTAL_FILT_EXEC_QA,REVENUE_STATS_FILT_EXEC_QA,REVENUE_STATS_LIST_FILT_EXEC_QA,EARNINGS_TOTAL_FILT_EXEC_QA,EARNINGS_STATS_FILT_EXEC_QA,EARNINGS_STATS_LIST_FILT_EXEC_QA,PROFITABILITY_TOTAL_FILT_EXEC_QA,PROFITABILITY_STATS_FILT_EXEC_QA,PROFITABILITY_STATS_LIST_FILT_EXEC_QA,OPERATING_INCOME_TOTAL_FILT_EXEC_QA,OPERATING_INCOME_STATS_FILT_EXEC_QA,OPERATING_INCOME_STATS_LIST_FILT_EXEC_QA,CASH_FLOWS_TOTAL_FILT_EXEC_QA,CASH_FLOWS_STATS_FILT_EXEC_QA,CASH_FLOWS_STATS_LIST_FILT_EXEC_QA,SHAREHOLDER_RETURNS_TOTAL_FILT_EXEC_QA,SHAREHOLDER_RETURNS_STATS_FILT_EXEC_QA,SHAREHOLDER_RETURNS_STATS_LIST_FILT_EXEC_QA,CAPITAL_USAGE_TOTAL_FILT_EXEC_QA,CAPITAL_USAGE_STATS_FILT_EXEC_QA,CAPITAL_USAGE_STATS_LIST_FILT_EXEC_QA,GUIDANCE_TOTAL_FILT_EXEC_QA,GUIDANCE_STATS_FILT_EXEC_QA,GUIDANCE_STATS_LIST_FILT_EXEC_QA,NUM_SENTS_FILT_EXEC_QA,LEN_FILT_ANL_QA,RAW_LEN_FILT_ANL_QA,REVENUE_TOTAL_FILT_ANL_QA,REVENUE_STATS_FILT_ANL_QA,REVENUE_STATS_LIST_FILT_ANL_QA,EARNINGS_TOTAL_FILT_ANL_QA,EARNINGS_STATS_FILT_ANL_QA,EARNINGS_STATS_LIST_FILT_ANL_QA,PROFITABILITY_TOTAL_FILT_ANL_QA,PROFITABILITY_STATS_FILT_ANL_QA,PROFITABILITY_STATS_LIST_FILT_ANL_QA,OPERATING_INCOME_TOTAL_FILT_ANL_QA,OPERATING_INCOME_STATS_FILT_ANL_QA,OPERATING_INCOME_STATS_LIST_FILT_ANL_QA,CASH_FLOWS_TOTAL_FILT_ANL_QA,CASH_FLOWS_STATS_FILT_ANL_QA,CASH_FLOWS_STATS_LIST_FILT_ANL_QA,SHAREHOLDER_RETURNS_TOTAL_FILT_ANL_QA,SHAREHOLDER_RETURNS_STATS_FILT_ANL_QA,SHAREHOLDER_RETURNS_STATS_LIST_FILT_ANL_QA,CAPITAL_USAGE_TOTAL_FILT_ANL_QA,CAPITAL_USAGE_STATS_FILT_ANL_QA,CAPITAL_USAGE_STATS_LIST_FILT_ANL_QA,GUIDANCE_TOTAL_FILT_ANL_QA,GUIDANCE_STATS_FILT_ANL_QA,GUIDANCE_STATS_LIST_FILT_ANL_QA,NUM_SENTS_FILT_ANL_QA,SENT_FILT_MD,NET_SENT_FILT_MD,REVENUE_REL_FILT_MD,REVENUE_SENT_FILT_MD,REVENUE_SENT_REL_FILT_MD,REVENUE_SENT_WEIGHT_FILT_MD,REVENUE_SENT_WEIGHT_REL_FILT_MD,REVENUE_NET_SENT_FILT_MD,EARNINGS_REL_FILT_MD,EARNINGS_SENT_FILT_MD,EARNINGS_SENT_REL_FILT_MD,EARNINGS_SENT_WEIGHT_FILT_MD,EARNINGS_SENT_WEIGHT_REL_FILT_MD,EARNINGS_NET_SENT_FILT_MD,PROFITABILITY_REL_FILT_MD,PROFITABILITY_SENT_FILT_MD,PROFITABILITY_SENT_REL_FILT_MD,PROFITABILITY_SENT_WEIGHT_FILT_MD,PROFITABILITY_SENT_WEIGHT_REL_FILT_MD,PROFITABILITY_NET_SENT_FILT_MD,OPERATING_INCOME_REL_FILT_MD,OPERATING_INCOME_SENT_FILT_MD,OPERATING_INCOME_SENT_REL_FILT_MD,OPERATING_INCOME_SENT_WEIGHT_FILT_MD,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_MD,OPERATING_INCOME_NET_SENT_FILT_MD,CASH_FLOWS_REL_FILT_MD,CASH_FLOWS_SENT_FILT_MD,CASH_FLOWS_SENT_REL_FILT_MD,CASH_FLOWS_SENT_WEIGHT_FILT_MD,CASH_FLOWS_SENT_WEIGHT_REL_FILT_MD,CASH_FLOWS_NET_SENT_FILT_MD,SHAREHOLDER_RETURNS_REL_FILT_MD,SHAREHOLDER_RETURNS_SENT_FILT_MD,SHAREHOLDER_RETURNS_SENT_REL_FILT_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_MD,SHAREHOLDER_RETURNS_NET_SENT_FILT_MD,CAPITAL_USAGE_REL_FILT_MD,CAPITAL_USAGE_SENT_FILT_MD,CAPITAL_USAGE_SENT_REL_FILT_MD,CAPITAL_USAGE_SENT_WEIGHT_FILT_MD,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_MD,CAPITAL_USAGE_NET_SENT_FILT_MD,GUIDANCE_REL_FILT_MD,GUIDANCE_SENT_FILT_MD,GUIDANCE_SENT_REL_FILT_MD,GUIDANCE_SENT_WEIGHT_FILT_MD,GUIDANCE_SENT_WEIGHT_REL_FILT_MD,GUIDANCE_NET_SENT_FILT_MD,SENT_FILT_QA,NET_SENT_FILT_QA,REVENUE_REL_FILT_QA,REVENUE_SENT_FILT_QA,REVENUE_SENT_REL_FILT_QA,REVENUE_SENT_WEIGHT_FILT_QA,REVENUE_SENT_WEIGHT_REL_FILT_QA,REVENUE_NET_SENT_FILT_QA,EARNINGS_REL_FILT_QA,EARNINGS_SENT_FILT_QA,EARNINGS_SENT_REL_FILT_QA,EARNINGS_SENT_WEIGHT_FILT_QA,EARNINGS_SENT_WEIGHT_REL_FILT_QA,EARNINGS_NET_SENT_FILT_QA,PROFITABILITY_REL_FILT_QA,PROFITABILITY_SENT_FILT_QA,PROFITABILITY_SENT_REL_FILT_QA,PROFITABILITY_SENT_WEIGHT_FILT_QA,PROFITABILITY_SENT_WEIGHT_REL_FILT_QA,PROFITABILITY_NET_SENT_FILT_QA,OPERATING_INCOME_REL_FILT_QA,OPERATING_INCOME_SENT_FILT_QA,OPERATING_INCOME_SENT_REL_FILT_QA,OPERATING_INCOME_SENT_WEIGHT_FILT_QA,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_QA,OPERATING_INCOME_NET_SENT_FILT_QA,CASH_FLOWS_REL_FILT_QA,CASH_FLOWS_SENT_FILT_QA,CASH_FLOWS_SENT_REL_FILT_QA,CASH_FLOWS_SENT_WEIGHT_FILT_QA,CASH_FLOWS_SENT_WEIGHT_REL_FILT_QA,CASH_FLOWS_NET_SENT_FILT_QA,SHAREHOLDER_RETURNS_REL_FILT_QA,SHAREHOLDER_RETURNS_SENT_FILT_QA,SHAREHOLDER_RETURNS_SENT_REL_FILT_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_QA,SHAREHOLDER_RETURNS_NET_SENT_FILT_QA,CAPITAL_USAGE_REL_FILT_QA,CAPITAL_USAGE_SENT_FILT_QA,CAPITAL_USAGE_SENT_REL_FILT_QA,CAPITAL_USAGE_SENT_WEIGHT_FILT_QA,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_QA,CAPITAL_USAGE_NET_SENT_FILT_QA,GUIDANCE_REL_FILT_QA,GUIDANCE_SENT_FILT_QA,GUIDANCE_SENT_REL_FILT_QA,GUIDANCE_SENT_WEIGHT_FILT_QA,GUIDANCE_SENT_WEIGHT_REL_FILT_QA,GUIDANCE_NET_SENT_FILT_QA,SENT_FILT_CEO_MD,NET_SENT_FILT_CEO_MD,REVENUE_REL_FILT_CEO_MD,REVENUE_SENT_FILT_CEO_MD,REVENUE_SENT_REL_FILT_CEO_MD,REVENUE_SENT_WEIGHT_FILT_CEO_MD,REVENUE_SENT_WEIGHT_REL_FILT_CEO_MD,REVENUE_NET_SENT_FILT_CEO_MD,EARNINGS_REL_FILT_CEO_MD,EARNINGS_SENT_FILT_CEO_MD,EARNINGS_SENT_REL_FILT_CEO_MD,EARNINGS_SENT_WEIGHT_FILT_CEO_MD,EARNINGS_SENT_WEIGHT_REL_FILT_CEO_MD,EARNINGS_NET_SENT_FILT_CEO_MD,PROFITABILITY_REL_FILT_CEO_MD,PROFITABILITY_SENT_FILT_CEO_MD,PROFITABILITY_SENT_REL_FILT_CEO_MD,PROFITABILITY_SENT_WEIGHT_FILT_CEO_MD,PROFITABILITY_SENT_WEIGHT_REL_FILT_CEO_MD,PROFITABILITY_NET_SENT_FILT_CEO_MD,OPERATING_INCOME_REL_FILT_CEO_MD,OPERATING_INCOME_SENT_FILT_CEO_MD,OPERATING_INCOME_SENT_REL_FILT_CEO_MD,OPERATING_INCOME_SENT_WEIGHT_FILT_CEO_MD,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_CEO_MD,OPERATING_INCOME_NET_SENT_FILT_CEO_MD,CASH_FLOWS_REL_FILT_CEO_MD,CASH_FLOWS_SENT_FILT_CEO_MD,CASH_FLOWS_SENT_REL_FILT_CEO_MD,CASH_FLOWS_SENT_WEIGHT_FILT_CEO_MD,CASH_FLOWS_SENT_WEIGHT_REL_FILT_CEO_MD,CASH_FLOWS_NET_SENT_FILT_CEO_MD,SHAREHOLDER_RETURNS_REL_FILT_CEO_MD,SHAREHOLDER_RETURNS_SENT_FILT_CEO_MD,SHAREHOLDER_RETURNS_SENT_REL_FILT_CEO_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_CEO_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_CEO_MD,SHAREHOLDER_RETURNS_NET_SENT_FILT_CEO_MD,CAPITAL_USAGE_REL_FILT_CEO_MD,CAPITAL_USAGE_SENT_FILT_CEO_MD,CAPITAL_USAGE_SENT_REL_FILT_CEO_MD,CAPITAL_USAGE_SENT_WEIGHT_FILT_CEO_MD,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_CEO_MD,CAPITAL_USAGE_NET_SENT_FILT_CEO_MD,GUIDANCE_REL_FILT_CEO_MD,GUIDANCE_SENT_FILT_CEO_MD,GUIDANCE_SENT_REL_FILT_CEO_MD,GUIDANCE_SENT_WEIGHT_FILT_CEO_MD,GUIDANCE_SENT_WEIGHT_REL_FILT_CEO_MD,GUIDANCE_NET_SENT_FILT_CEO_MD,SENT_FILT_CEO_QA,NET_SENT_FILT_CEO_QA,REVENUE_REL_FILT_CEO_QA,REVENUE_SENT_FILT_CEO_QA,REVENUE_SENT_REL_FILT_CEO_QA,REVENUE_SENT_WEIGHT_FILT_CEO_QA,REVENUE_SENT_WEIGHT_REL_FILT_CEO_QA,REVENUE_NET_SENT_FILT_CEO_QA,EARNINGS_REL_FILT_CEO_QA,EARNINGS_SENT_FILT_CEO_QA,EARNINGS_SENT_REL_FILT_CEO_QA,EARNINGS_SENT_WEIGHT_FILT_CEO_QA,EARNINGS_SENT_WEIGHT_REL_FILT_CEO_QA,EARNINGS_NET_SENT_FILT_CEO_QA,PROFITABILITY_REL_FILT_CEO_QA,PROFITABILITY_SENT_FILT_CEO_QA,PROFITABILITY_SENT_REL_FILT_CEO_QA,PROFITABILITY_SENT_WEIGHT_FILT_CEO_QA,PROFITABILITY_SENT_WEIGHT_REL_FILT_CEO_QA,PROFITABILITY_NET_SENT_FILT_CEO_QA,OPERATING_INCOME_REL_FILT_CEO_QA,OPERATING_INCOME_SENT_FILT_CEO_QA,OPERATING_INCOME_SENT_REL_FILT_CEO_QA,OPERATING_INCOME_SENT_WEIGHT_FILT_CEO_QA,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_CEO_QA,OPERATING_INCOME_NET_SENT_FILT_CEO_QA,CASH_FLOWS_REL_FILT_CEO_QA,CASH_FLOWS_SENT_FILT_CEO_QA,CASH_FLOWS_SENT_REL_FILT_CEO_QA,CASH_FLOWS_SENT_WEIGHT_FILT_CEO_QA,CASH_FLOWS_SENT_WEIGHT_REL_FILT_CEO_QA,CASH_FLOWS_NET_SENT_FILT_CEO_QA,SHAREHOLDER_RETURNS_REL_FILT_CEO_QA,SHAREHOLDER_RETURNS_SENT_FILT_CEO_QA,SHAREHOLDER_RETURNS_SENT_REL_FILT_CEO_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_CEO_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_CEO_QA,SHAREHOLDER_RETURNS_NET_SENT_FILT_CEO_QA,CAPITAL_USAGE_REL_FILT_CEO_QA,CAPITAL_USAGE_SENT_FILT_CEO_QA,CAPITAL_USAGE_SENT_REL_FILT_CEO_QA,CAPITAL_USAGE_SENT_WEIGHT_FILT_CEO_QA,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_CEO_QA,CAPITAL_USAGE_NET_SENT_FILT_CEO_QA,GUIDANCE_REL_FILT_CEO_QA,GUIDANCE_SENT_FILT_CEO_QA,GUIDANCE_SENT_REL_FILT_CEO_QA,GUIDANCE_SENT_WEIGHT_FILT_CEO_QA,GUIDANCE_SENT_WEIGHT_REL_FILT_CEO_QA,GUIDANCE_NET_SENT_FILT_CEO_QA,SENT_FILT_EXEC_MD,NET_SENT_FILT_EXEC_MD,REVENUE_REL_FILT_EXEC_MD,REVENUE_SENT_FILT_EXEC_MD,REVENUE_SENT_REL_FILT_EXEC_MD,REVENUE_SENT_WEIGHT_FILT_EXEC_MD,REVENUE_SENT_WEIGHT_REL_FILT_EXEC_MD,REVENUE_NET_SENT_FILT_EXEC_MD,EARNINGS_REL_FILT_EXEC_MD,EARNINGS_SENT_FILT_EXEC_MD,EARNINGS_SENT_REL_FILT_EXEC_MD,EARNINGS_SENT_WEIGHT_FILT_EXEC_MD,EARNINGS_SENT_WEIGHT_REL_FILT_EXEC_MD,EARNINGS_NET_SENT_FILT_EXEC_MD,PROFITABILITY_REL_FILT_EXEC_MD,PROFITABILITY_SENT_FILT_EXEC_MD,PROFITABILITY_SENT_REL_FILT_EXEC_MD,PROFITABILITY_SENT_WEIGHT_FILT_EXEC_MD,PROFITABILITY_SENT_WEIGHT_REL_FILT_EXEC_MD,PROFITABILITY_NET_SENT_FILT_EXEC_MD,OPERATING_INCOME_REL_FILT_EXEC_MD,OPERATING_INCOME_SENT_FILT_EXEC_MD,OPERATING_INCOME_SENT_REL_FILT_EXEC_MD,OPERATING_INCOME_SENT_WEIGHT_FILT_EXEC_MD,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_EXEC_MD,OPERATING_INCOME_NET_SENT_FILT_EXEC_MD,CASH_FLOWS_REL_FILT_EXEC_MD,CASH_FLOWS_SENT_FILT_EXEC_MD,CASH_FLOWS_SENT_REL_FILT_EXEC_MD,CASH_FLOWS_SENT_WEIGHT_FILT_EXEC_MD,CASH_FLOWS_SENT_WEIGHT_REL_FILT_EXEC_MD,CASH_FLOWS_NET_SENT_FILT_EXEC_MD,SHAREHOLDER_RETURNS_REL_FILT_EXEC_MD,SHAREHOLDER_RETURNS_SENT_FILT_EXEC_MD,SHAREHOLDER_RETURNS_SENT_REL_FILT_EXEC_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_EXEC_MD,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_EXEC_MD,SHAREHOLDER_RETURNS_NET_SENT_FILT_EXEC_MD,CAPITAL_USAGE_REL_FILT_EXEC_MD,CAPITAL_USAGE_SENT_FILT_EXEC_MD,CAPITAL_USAGE_SENT_REL_FILT_EXEC_MD,CAPITAL_USAGE_SENT_WEIGHT_FILT_EXEC_MD,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_EXEC_MD,CAPITAL_USAGE_NET_SENT_FILT_EXEC_MD,GUIDANCE_REL_FILT_EXEC_MD,GUIDANCE_SENT_FILT_EXEC_MD,GUIDANCE_SENT_REL_FILT_EXEC_MD,GUIDANCE_SENT_WEIGHT_FILT_EXEC_MD,GUIDANCE_SENT_WEIGHT_REL_FILT_EXEC_MD,GUIDANCE_NET_SENT_FILT_EXEC_MD,SENT_FILT_EXEC_QA,NET_SENT_FILT_EXEC_QA,REVENUE_REL_FILT_EXEC_QA,REVENUE_SENT_FILT_EXEC_QA,REVENUE_SENT_REL_FILT_EXEC_QA,REVENUE_SENT_WEIGHT_FILT_EXEC_QA,REVENUE_SENT_WEIGHT_REL_FILT_EXEC_QA,REVENUE_NET_SENT_FILT_EXEC_QA,EARNINGS_REL_FILT_EXEC_QA,EARNINGS_SENT_FILT_EXEC_QA,EARNINGS_SENT_REL_FILT_EXEC_QA,EARNINGS_SENT_WEIGHT_FILT_EXEC_QA,EARNINGS_SENT_WEIGHT_REL_FILT_EXEC_QA,EARNINGS_NET_SENT_FILT_EXEC_QA,PROFITABILITY_REL_FILT_EXEC_QA,PROFITABILITY_SENT_FILT_EXEC_QA,PROFITABILITY_SENT_REL_FILT_EXEC_QA,PROFITABILITY_SENT_WEIGHT_FILT_EXEC_QA,PROFITABILITY_SENT_WEIGHT_REL_FILT_EXEC_QA,PROFITABILITY_NET_SENT_FILT_EXEC_QA,OPERATING_INCOME_REL_FILT_EXEC_QA,OPERATING_INCOME_SENT_FILT_EXEC_QA,OPERATING_INCOME_SENT_REL_FILT_EXEC_QA,OPERATING_INCOME_SENT_WEIGHT_FILT_EXEC_QA,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_EXEC_QA,OPERATING_INCOME_NET_SENT_FILT_EXEC_QA,CASH_FLOWS_REL_FILT_EXEC_QA,CASH_FLOWS_SENT_FILT_EXEC_QA,CASH_FLOWS_SENT_REL_FILT_EXEC_QA,CASH_FLOWS_SENT_WEIGHT_FILT_EXEC_QA,CASH_FLOWS_SENT_WEIGHT_REL_FILT_EXEC_QA,CASH_FLOWS_NET_SENT_FILT_EXEC_QA,SHAREHOLDER_RETURNS_REL_FILT_EXEC_QA,SHAREHOLDER_RETURNS_SENT_FILT_EXEC_QA,SHAREHOLDER_RETURNS_SENT_REL_FILT_EXEC_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_EXEC_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_EXEC_QA,SHAREHOLDER_RETURNS_NET_SENT_FILT_EXEC_QA,CAPITAL_USAGE_REL_FILT_EXEC_QA,CAPITAL_USAGE_SENT_FILT_EXEC_QA,CAPITAL_USAGE_SENT_REL_FILT_EXEC_QA,CAPITAL_USAGE_SENT_WEIGHT_FILT_EXEC_QA,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_EXEC_QA,CAPITAL_USAGE_NET_SENT_FILT_EXEC_QA,GUIDANCE_REL_FILT_EXEC_QA,GUIDANCE_SENT_FILT_EXEC_QA,GUIDANCE_SENT_REL_FILT_EXEC_QA,GUIDANCE_SENT_WEIGHT_FILT_EXEC_QA,GUIDANCE_SENT_WEIGHT_REL_FILT_EXEC_QA,GUIDANCE_NET_SENT_FILT_EXEC_QA,SENT_FILT_ANL_QA,NET_SENT_FILT_ANL_QA,REVENUE_REL_FILT_ANL_QA,REVENUE_SENT_FILT_ANL_QA,REVENUE_SENT_REL_FILT_ANL_QA,REVENUE_SENT_WEIGHT_FILT_ANL_QA,REVENUE_SENT_WEIGHT_REL_FILT_ANL_QA,REVENUE_NET_SENT_FILT_ANL_QA,EARNINGS_REL_FILT_ANL_QA,EARNINGS_SENT_FILT_ANL_QA,EARNINGS_SENT_REL_FILT_ANL_QA,EARNINGS_SENT_WEIGHT_FILT_ANL_QA,EARNINGS_SENT_WEIGHT_REL_FILT_ANL_QA,EARNINGS_NET_SENT_FILT_ANL_QA,PROFITABILITY_REL_FILT_ANL_QA,PROFITABILITY_SENT_FILT_ANL_QA,PROFITABILITY_SENT_REL_FILT_ANL_QA,PROFITABILITY_SENT_WEIGHT_FILT_ANL_QA,PROFITABILITY_SENT_WEIGHT_REL_FILT_ANL_QA,PROFITABILITY_NET_SENT_FILT_ANL_QA,OPERATING_INCOME_REL_FILT_ANL_QA,OPERATING_INCOME_SENT_FILT_ANL_QA,OPERATING_INCOME_SENT_REL_FILT_ANL_QA,OPERATING_INCOME_SENT_WEIGHT_FILT_ANL_QA,OPERATING_INCOME_SENT_WEIGHT_REL_FILT_ANL_QA,OPERATING_INCOME_NET_SENT_FILT_ANL_QA,CASH_FLOWS_REL_FILT_ANL_QA,CASH_FLOWS_SENT_FILT_ANL_QA,CASH_FLOWS_SENT_REL_FILT_ANL_QA,CASH_FLOWS_SENT_WEIGHT_FILT_ANL_QA,CASH_FLOWS_SENT_WEIGHT_REL_FILT_ANL_QA,CASH_FLOWS_NET_SENT_FILT_ANL_QA,SHAREHOLDER_RETURNS_REL_FILT_ANL_QA,SHAREHOLDER_RETURNS_SENT_FILT_ANL_QA,SHAREHOLDER_RETURNS_SENT_REL_FILT_ANL_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_ANL_QA,SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_ANL_QA,SHAREHOLDER_RETURNS_NET_SENT_FILT_ANL_QA,CAPITAL_USAGE_REL_FILT_ANL_QA,CAPITAL_USAGE_SENT_FILT_ANL_QA,CAPITAL_USAGE_SENT_REL_FILT_ANL_QA,CAPITAL_USAGE_SENT_WEIGHT_FILT_ANL_QA,CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_ANL_QA,CAPITAL_USAGE_NET_SENT_FILT_ANL_QA,GUIDANCE_REL_FILT_ANL_QA,GUIDANCE_SENT_FILT_ANL_QA,GUIDANCE_SENT_REL_FILT_ANL_QA,GUIDANCE_SENT_WEIGHT_FILT_ANL_QA,GUIDANCE_SENT_WEIGHT_REL_FILT_ANL_QA,GUIDANCE_NET_SENT_FILT_ANL_QA) 
     VALUES (B.ENTITY_ID,B.DATE,B.CALL_NAME,B.COMPANY_NAME,B.EARNINGS_CALL,B.ERROR,B.TRANSCRIPT_STATUS,B.CALL_ID,B.UPLOAD_DT_UTC,B.VERSION_ID,B.EVENT_DATETIME_UTC,B.PARSED_DATETIME_EASTERN_TZ,B.FILT_MD,B.FILT_QA,B.FILT_CEO_MD,B.FILT_CEO_QA,B.FILT_EXEC_MD,B.FILT_EXEC_QA,B.FILT_ANL_QA,B.SENT_SCORES_FILT_MD,B.SENT_LABELS_FILT_MD,B.SENT_SCORES_FILT_QA,B.SENT_LABELS_FILT_QA,B.SENT_SCORES_FILT_CEO_MD,B.SENT_LABELS_FILT_CEO_MD,B.SENT_SCORES_FILT_CEO_QA,B.SENT_LABELS_FILT_CEO_QA,B.SENT_SCORES_FILT_EXEC_MD,B.SENT_LABELS_FILT_EXEC_MD,B.SENT_SCORES_FILT_EXEC_QA,B.SENT_LABELS_FILT_EXEC_QA,B.SENT_SCORES_FILT_ANL_QA,B.SENT_LABELS_FILT_ANL_QA,B.LEN_FILT_MD,B.RAW_LEN_FILT_MD,B.REVENUE_TOTAL_FILT_MD,B.REVENUE_STATS_FILT_MD,B.REVENUE_STATS_LIST_FILT_MD,B.EARNINGS_TOTAL_FILT_MD,B.EARNINGS_STATS_FILT_MD,B.EARNINGS_STATS_LIST_FILT_MD,B.PROFITABILITY_TOTAL_FILT_MD,B.PROFITABILITY_STATS_FILT_MD,B.PROFITABILITY_STATS_LIST_FILT_MD,B.OPERATING_INCOME_TOTAL_FILT_MD,B.OPERATING_INCOME_STATS_FILT_MD,B.OPERATING_INCOME_STATS_LIST_FILT_MD,B.CASH_FLOWS_TOTAL_FILT_MD,B.CASH_FLOWS_STATS_FILT_MD,B.CASH_FLOWS_STATS_LIST_FILT_MD,B.SHAREHOLDER_RETURNS_TOTAL_FILT_MD,B.SHAREHOLDER_RETURNS_STATS_FILT_MD,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_MD,B.CAPITAL_USAGE_TOTAL_FILT_MD,B.CAPITAL_USAGE_STATS_FILT_MD,B.CAPITAL_USAGE_STATS_LIST_FILT_MD,B.GUIDANCE_TOTAL_FILT_MD,B.GUIDANCE_STATS_FILT_MD,B.GUIDANCE_STATS_LIST_FILT_MD,B.NUM_SENTS_FILT_MD,B.LEN_FILT_QA,B.RAW_LEN_FILT_QA,B.REVENUE_TOTAL_FILT_QA,B.REVENUE_STATS_FILT_QA,B.REVENUE_STATS_LIST_FILT_QA,B.EARNINGS_TOTAL_FILT_QA,B.EARNINGS_STATS_FILT_QA,B.EARNINGS_STATS_LIST_FILT_QA,B.PROFITABILITY_TOTAL_FILT_QA,B.PROFITABILITY_STATS_FILT_QA,B.PROFITABILITY_STATS_LIST_FILT_QA,B.OPERATING_INCOME_TOTAL_FILT_QA,B.OPERATING_INCOME_STATS_FILT_QA,B.OPERATING_INCOME_STATS_LIST_FILT_QA,B.CASH_FLOWS_TOTAL_FILT_QA,B.CASH_FLOWS_STATS_FILT_QA,B.CASH_FLOWS_STATS_LIST_FILT_QA,B.SHAREHOLDER_RETURNS_TOTAL_FILT_QA,B.SHAREHOLDER_RETURNS_STATS_FILT_QA,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_QA,B.CAPITAL_USAGE_TOTAL_FILT_QA,B.CAPITAL_USAGE_STATS_FILT_QA,B.CAPITAL_USAGE_STATS_LIST_FILT_QA,B.GUIDANCE_TOTAL_FILT_QA,B.GUIDANCE_STATS_FILT_QA,B.GUIDANCE_STATS_LIST_FILT_QA,B.NUM_SENTS_FILT_QA,B.LEN_FILT_CEO_MD,B.RAW_LEN_FILT_CEO_MD,B.REVENUE_TOTAL_FILT_CEO_MD,B.REVENUE_STATS_FILT_CEO_MD,B.REVENUE_STATS_LIST_FILT_CEO_MD,B.EARNINGS_TOTAL_FILT_CEO_MD,B.EARNINGS_STATS_FILT_CEO_MD,B.EARNINGS_STATS_LIST_FILT_CEO_MD,B.PROFITABILITY_TOTAL_FILT_CEO_MD,B.PROFITABILITY_STATS_FILT_CEO_MD,B.PROFITABILITY_STATS_LIST_FILT_CEO_MD,B.OPERATING_INCOME_TOTAL_FILT_CEO_MD,B.OPERATING_INCOME_STATS_FILT_CEO_MD,B.OPERATING_INCOME_STATS_LIST_FILT_CEO_MD,B.CASH_FLOWS_TOTAL_FILT_CEO_MD,B.CASH_FLOWS_STATS_FILT_CEO_MD,B.CASH_FLOWS_STATS_LIST_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_TOTAL_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_STATS_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_CEO_MD,B.CAPITAL_USAGE_TOTAL_FILT_CEO_MD,B.CAPITAL_USAGE_STATS_FILT_CEO_MD,B.CAPITAL_USAGE_STATS_LIST_FILT_CEO_MD,B.GUIDANCE_TOTAL_FILT_CEO_MD,B.GUIDANCE_STATS_FILT_CEO_MD,B.GUIDANCE_STATS_LIST_FILT_CEO_MD,B.NUM_SENTS_FILT_CEO_MD,B.LEN_FILT_CEO_QA,B.RAW_LEN_FILT_CEO_QA,B.REVENUE_TOTAL_FILT_CEO_QA,B.REVENUE_STATS_FILT_CEO_QA,B.REVENUE_STATS_LIST_FILT_CEO_QA,B.EARNINGS_TOTAL_FILT_CEO_QA,B.EARNINGS_STATS_FILT_CEO_QA,B.EARNINGS_STATS_LIST_FILT_CEO_QA,B.PROFITABILITY_TOTAL_FILT_CEO_QA,B.PROFITABILITY_STATS_FILT_CEO_QA,B.PROFITABILITY_STATS_LIST_FILT_CEO_QA,B.OPERATING_INCOME_TOTAL_FILT_CEO_QA,B.OPERATING_INCOME_STATS_FILT_CEO_QA,B.OPERATING_INCOME_STATS_LIST_FILT_CEO_QA,B.CASH_FLOWS_TOTAL_FILT_CEO_QA,B.CASH_FLOWS_STATS_FILT_CEO_QA,B.CASH_FLOWS_STATS_LIST_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_TOTAL_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_STATS_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_CEO_QA,B.CAPITAL_USAGE_TOTAL_FILT_CEO_QA,B.CAPITAL_USAGE_STATS_FILT_CEO_QA,B.CAPITAL_USAGE_STATS_LIST_FILT_CEO_QA,B.GUIDANCE_TOTAL_FILT_CEO_QA,B.GUIDANCE_STATS_FILT_CEO_QA,B.GUIDANCE_STATS_LIST_FILT_CEO_QA,B.NUM_SENTS_FILT_CEO_QA,B.LEN_FILT_EXEC_MD,B.RAW_LEN_FILT_EXEC_MD,B.REVENUE_TOTAL_FILT_EXEC_MD,B.REVENUE_STATS_FILT_EXEC_MD,B.REVENUE_STATS_LIST_FILT_EXEC_MD,B.EARNINGS_TOTAL_FILT_EXEC_MD,B.EARNINGS_STATS_FILT_EXEC_MD,B.EARNINGS_STATS_LIST_FILT_EXEC_MD,B.PROFITABILITY_TOTAL_FILT_EXEC_MD,B.PROFITABILITY_STATS_FILT_EXEC_MD,B.PROFITABILITY_STATS_LIST_FILT_EXEC_MD,B.OPERATING_INCOME_TOTAL_FILT_EXEC_MD,B.OPERATING_INCOME_STATS_FILT_EXEC_MD,B.OPERATING_INCOME_STATS_LIST_FILT_EXEC_MD,B.CASH_FLOWS_TOTAL_FILT_EXEC_MD,B.CASH_FLOWS_STATS_FILT_EXEC_MD,B.CASH_FLOWS_STATS_LIST_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_TOTAL_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_STATS_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_EXEC_MD,B.CAPITAL_USAGE_TOTAL_FILT_EXEC_MD,B.CAPITAL_USAGE_STATS_FILT_EXEC_MD,B.CAPITAL_USAGE_STATS_LIST_FILT_EXEC_MD,B.GUIDANCE_TOTAL_FILT_EXEC_MD,B.GUIDANCE_STATS_FILT_EXEC_MD,B.GUIDANCE_STATS_LIST_FILT_EXEC_MD,B.NUM_SENTS_FILT_EXEC_MD,B.LEN_FILT_EXEC_QA,B.RAW_LEN_FILT_EXEC_QA,B.REVENUE_TOTAL_FILT_EXEC_QA,B.REVENUE_STATS_FILT_EXEC_QA,B.REVENUE_STATS_LIST_FILT_EXEC_QA,B.EARNINGS_TOTAL_FILT_EXEC_QA,B.EARNINGS_STATS_FILT_EXEC_QA,B.EARNINGS_STATS_LIST_FILT_EXEC_QA,B.PROFITABILITY_TOTAL_FILT_EXEC_QA,B.PROFITABILITY_STATS_FILT_EXEC_QA,B.PROFITABILITY_STATS_LIST_FILT_EXEC_QA,B.OPERATING_INCOME_TOTAL_FILT_EXEC_QA,B.OPERATING_INCOME_STATS_FILT_EXEC_QA,B.OPERATING_INCOME_STATS_LIST_FILT_EXEC_QA,B.CASH_FLOWS_TOTAL_FILT_EXEC_QA,B.CASH_FLOWS_STATS_FILT_EXEC_QA,B.CASH_FLOWS_STATS_LIST_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_TOTAL_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_STATS_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_EXEC_QA,B.CAPITAL_USAGE_TOTAL_FILT_EXEC_QA,B.CAPITAL_USAGE_STATS_FILT_EXEC_QA,B.CAPITAL_USAGE_STATS_LIST_FILT_EXEC_QA,B.GUIDANCE_TOTAL_FILT_EXEC_QA,B.GUIDANCE_STATS_FILT_EXEC_QA,B.GUIDANCE_STATS_LIST_FILT_EXEC_QA,B.NUM_SENTS_FILT_EXEC_QA,B.LEN_FILT_ANL_QA,B.RAW_LEN_FILT_ANL_QA,B.REVENUE_TOTAL_FILT_ANL_QA,B.REVENUE_STATS_FILT_ANL_QA,B.REVENUE_STATS_LIST_FILT_ANL_QA,B.EARNINGS_TOTAL_FILT_ANL_QA,B.EARNINGS_STATS_FILT_ANL_QA,B.EARNINGS_STATS_LIST_FILT_ANL_QA,B.PROFITABILITY_TOTAL_FILT_ANL_QA,B.PROFITABILITY_STATS_FILT_ANL_QA,B.PROFITABILITY_STATS_LIST_FILT_ANL_QA,B.OPERATING_INCOME_TOTAL_FILT_ANL_QA,B.OPERATING_INCOME_STATS_FILT_ANL_QA,B.OPERATING_INCOME_STATS_LIST_FILT_ANL_QA,B.CASH_FLOWS_TOTAL_FILT_ANL_QA,B.CASH_FLOWS_STATS_FILT_ANL_QA,B.CASH_FLOWS_STATS_LIST_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_TOTAL_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_STATS_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_STATS_LIST_FILT_ANL_QA,B.CAPITAL_USAGE_TOTAL_FILT_ANL_QA,B.CAPITAL_USAGE_STATS_FILT_ANL_QA,B.CAPITAL_USAGE_STATS_LIST_FILT_ANL_QA,B.GUIDANCE_TOTAL_FILT_ANL_QA,B.GUIDANCE_STATS_FILT_ANL_QA,B.GUIDANCE_STATS_LIST_FILT_ANL_QA,B.NUM_SENTS_FILT_ANL_QA,B.SENT_FILT_MD,B.NET_SENT_FILT_MD,B.REVENUE_REL_FILT_MD,B.REVENUE_SENT_FILT_MD,B.REVENUE_SENT_REL_FILT_MD,B.REVENUE_SENT_WEIGHT_FILT_MD,B.REVENUE_SENT_WEIGHT_REL_FILT_MD,B.REVENUE_NET_SENT_FILT_MD,B.EARNINGS_REL_FILT_MD,B.EARNINGS_SENT_FILT_MD,B.EARNINGS_SENT_REL_FILT_MD,B.EARNINGS_SENT_WEIGHT_FILT_MD,B.EARNINGS_SENT_WEIGHT_REL_FILT_MD,B.EARNINGS_NET_SENT_FILT_MD,B.PROFITABILITY_REL_FILT_MD,B.PROFITABILITY_SENT_FILT_MD,B.PROFITABILITY_SENT_REL_FILT_MD,B.PROFITABILITY_SENT_WEIGHT_FILT_MD,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_MD,B.PROFITABILITY_NET_SENT_FILT_MD,B.OPERATING_INCOME_REL_FILT_MD,B.OPERATING_INCOME_SENT_FILT_MD,B.OPERATING_INCOME_SENT_REL_FILT_MD,B.OPERATING_INCOME_SENT_WEIGHT_FILT_MD,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_MD,B.OPERATING_INCOME_NET_SENT_FILT_MD,B.CASH_FLOWS_REL_FILT_MD,B.CASH_FLOWS_SENT_FILT_MD,B.CASH_FLOWS_SENT_REL_FILT_MD,B.CASH_FLOWS_SENT_WEIGHT_FILT_MD,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_MD,B.CASH_FLOWS_NET_SENT_FILT_MD,B.SHAREHOLDER_RETURNS_REL_FILT_MD,B.SHAREHOLDER_RETURNS_SENT_FILT_MD,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_MD,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_MD,B.CAPITAL_USAGE_REL_FILT_MD,B.CAPITAL_USAGE_SENT_FILT_MD,B.CAPITAL_USAGE_SENT_REL_FILT_MD,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_MD,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_MD,B.CAPITAL_USAGE_NET_SENT_FILT_MD,B.GUIDANCE_REL_FILT_MD,B.GUIDANCE_SENT_FILT_MD,B.GUIDANCE_SENT_REL_FILT_MD,B.GUIDANCE_SENT_WEIGHT_FILT_MD,B.GUIDANCE_SENT_WEIGHT_REL_FILT_MD,B.GUIDANCE_NET_SENT_FILT_MD,B.SENT_FILT_QA,B.NET_SENT_FILT_QA,B.REVENUE_REL_FILT_QA,B.REVENUE_SENT_FILT_QA,B.REVENUE_SENT_REL_FILT_QA,B.REVENUE_SENT_WEIGHT_FILT_QA,B.REVENUE_SENT_WEIGHT_REL_FILT_QA,B.REVENUE_NET_SENT_FILT_QA,B.EARNINGS_REL_FILT_QA,B.EARNINGS_SENT_FILT_QA,B.EARNINGS_SENT_REL_FILT_QA,B.EARNINGS_SENT_WEIGHT_FILT_QA,B.EARNINGS_SENT_WEIGHT_REL_FILT_QA,B.EARNINGS_NET_SENT_FILT_QA,B.PROFITABILITY_REL_FILT_QA,B.PROFITABILITY_SENT_FILT_QA,B.PROFITABILITY_SENT_REL_FILT_QA,B.PROFITABILITY_SENT_WEIGHT_FILT_QA,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_QA,B.PROFITABILITY_NET_SENT_FILT_QA,B.OPERATING_INCOME_REL_FILT_QA,B.OPERATING_INCOME_SENT_FILT_QA,B.OPERATING_INCOME_SENT_REL_FILT_QA,B.OPERATING_INCOME_SENT_WEIGHT_FILT_QA,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_QA,B.OPERATING_INCOME_NET_SENT_FILT_QA,B.CASH_FLOWS_REL_FILT_QA,B.CASH_FLOWS_SENT_FILT_QA,B.CASH_FLOWS_SENT_REL_FILT_QA,B.CASH_FLOWS_SENT_WEIGHT_FILT_QA,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_QA,B.CASH_FLOWS_NET_SENT_FILT_QA,B.SHAREHOLDER_RETURNS_REL_FILT_QA,B.SHAREHOLDER_RETURNS_SENT_FILT_QA,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_QA,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_QA,B.CAPITAL_USAGE_REL_FILT_QA,B.CAPITAL_USAGE_SENT_FILT_QA,B.CAPITAL_USAGE_SENT_REL_FILT_QA,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_QA,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_QA,B.CAPITAL_USAGE_NET_SENT_FILT_QA,B.GUIDANCE_REL_FILT_QA,B.GUIDANCE_SENT_FILT_QA,B.GUIDANCE_SENT_REL_FILT_QA,B.GUIDANCE_SENT_WEIGHT_FILT_QA,B.GUIDANCE_SENT_WEIGHT_REL_FILT_QA,B.GUIDANCE_NET_SENT_FILT_QA,B.SENT_FILT_CEO_MD,B.NET_SENT_FILT_CEO_MD,B.REVENUE_REL_FILT_CEO_MD,B.REVENUE_SENT_FILT_CEO_MD,B.REVENUE_SENT_REL_FILT_CEO_MD,B.REVENUE_SENT_WEIGHT_FILT_CEO_MD,B.REVENUE_SENT_WEIGHT_REL_FILT_CEO_MD,B.REVENUE_NET_SENT_FILT_CEO_MD,B.EARNINGS_REL_FILT_CEO_MD,B.EARNINGS_SENT_FILT_CEO_MD,B.EARNINGS_SENT_REL_FILT_CEO_MD,B.EARNINGS_SENT_WEIGHT_FILT_CEO_MD,B.EARNINGS_SENT_WEIGHT_REL_FILT_CEO_MD,B.EARNINGS_NET_SENT_FILT_CEO_MD,B.PROFITABILITY_REL_FILT_CEO_MD,B.PROFITABILITY_SENT_FILT_CEO_MD,B.PROFITABILITY_SENT_REL_FILT_CEO_MD,B.PROFITABILITY_SENT_WEIGHT_FILT_CEO_MD,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_CEO_MD,B.PROFITABILITY_NET_SENT_FILT_CEO_MD,B.OPERATING_INCOME_REL_FILT_CEO_MD,B.OPERATING_INCOME_SENT_FILT_CEO_MD,B.OPERATING_INCOME_SENT_REL_FILT_CEO_MD,B.OPERATING_INCOME_SENT_WEIGHT_FILT_CEO_MD,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_CEO_MD,B.OPERATING_INCOME_NET_SENT_FILT_CEO_MD,B.CASH_FLOWS_REL_FILT_CEO_MD,B.CASH_FLOWS_SENT_FILT_CEO_MD,B.CASH_FLOWS_SENT_REL_FILT_CEO_MD,B.CASH_FLOWS_SENT_WEIGHT_FILT_CEO_MD,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_CEO_MD,B.CASH_FLOWS_NET_SENT_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_REL_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_SENT_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_CEO_MD,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_CEO_MD,B.CAPITAL_USAGE_REL_FILT_CEO_MD,B.CAPITAL_USAGE_SENT_FILT_CEO_MD,B.CAPITAL_USAGE_SENT_REL_FILT_CEO_MD,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_CEO_MD,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_CEO_MD,B.CAPITAL_USAGE_NET_SENT_FILT_CEO_MD,B.GUIDANCE_REL_FILT_CEO_MD,B.GUIDANCE_SENT_FILT_CEO_MD,B.GUIDANCE_SENT_REL_FILT_CEO_MD,B.GUIDANCE_SENT_WEIGHT_FILT_CEO_MD,B.GUIDANCE_SENT_WEIGHT_REL_FILT_CEO_MD,B.GUIDANCE_NET_SENT_FILT_CEO_MD,B.SENT_FILT_CEO_QA,B.NET_SENT_FILT_CEO_QA,B.REVENUE_REL_FILT_CEO_QA,B.REVENUE_SENT_FILT_CEO_QA,B.REVENUE_SENT_REL_FILT_CEO_QA,B.REVENUE_SENT_WEIGHT_FILT_CEO_QA,B.REVENUE_SENT_WEIGHT_REL_FILT_CEO_QA,B.REVENUE_NET_SENT_FILT_CEO_QA,B.EARNINGS_REL_FILT_CEO_QA,B.EARNINGS_SENT_FILT_CEO_QA,B.EARNINGS_SENT_REL_FILT_CEO_QA,B.EARNINGS_SENT_WEIGHT_FILT_CEO_QA,B.EARNINGS_SENT_WEIGHT_REL_FILT_CEO_QA,B.EARNINGS_NET_SENT_FILT_CEO_QA,B.PROFITABILITY_REL_FILT_CEO_QA,B.PROFITABILITY_SENT_FILT_CEO_QA,B.PROFITABILITY_SENT_REL_FILT_CEO_QA,B.PROFITABILITY_SENT_WEIGHT_FILT_CEO_QA,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_CEO_QA,B.PROFITABILITY_NET_SENT_FILT_CEO_QA,B.OPERATING_INCOME_REL_FILT_CEO_QA,B.OPERATING_INCOME_SENT_FILT_CEO_QA,B.OPERATING_INCOME_SENT_REL_FILT_CEO_QA,B.OPERATING_INCOME_SENT_WEIGHT_FILT_CEO_QA,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_CEO_QA,B.OPERATING_INCOME_NET_SENT_FILT_CEO_QA,B.CASH_FLOWS_REL_FILT_CEO_QA,B.CASH_FLOWS_SENT_FILT_CEO_QA,B.CASH_FLOWS_SENT_REL_FILT_CEO_QA,B.CASH_FLOWS_SENT_WEIGHT_FILT_CEO_QA,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_CEO_QA,B.CASH_FLOWS_NET_SENT_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_REL_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_SENT_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_CEO_QA,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_CEO_QA,B.CAPITAL_USAGE_REL_FILT_CEO_QA,B.CAPITAL_USAGE_SENT_FILT_CEO_QA,B.CAPITAL_USAGE_SENT_REL_FILT_CEO_QA,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_CEO_QA,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_CEO_QA,B.CAPITAL_USAGE_NET_SENT_FILT_CEO_QA,B.GUIDANCE_REL_FILT_CEO_QA,B.GUIDANCE_SENT_FILT_CEO_QA,B.GUIDANCE_SENT_REL_FILT_CEO_QA,B.GUIDANCE_SENT_WEIGHT_FILT_CEO_QA,B.GUIDANCE_SENT_WEIGHT_REL_FILT_CEO_QA,B.GUIDANCE_NET_SENT_FILT_CEO_QA,B.SENT_FILT_EXEC_MD,B.NET_SENT_FILT_EXEC_MD,B.REVENUE_REL_FILT_EXEC_MD,B.REVENUE_SENT_FILT_EXEC_MD,B.REVENUE_SENT_REL_FILT_EXEC_MD,B.REVENUE_SENT_WEIGHT_FILT_EXEC_MD,B.REVENUE_SENT_WEIGHT_REL_FILT_EXEC_MD,B.REVENUE_NET_SENT_FILT_EXEC_MD,B.EARNINGS_REL_FILT_EXEC_MD,B.EARNINGS_SENT_FILT_EXEC_MD,B.EARNINGS_SENT_REL_FILT_EXEC_MD,B.EARNINGS_SENT_WEIGHT_FILT_EXEC_MD,B.EARNINGS_SENT_WEIGHT_REL_FILT_EXEC_MD,B.EARNINGS_NET_SENT_FILT_EXEC_MD,B.PROFITABILITY_REL_FILT_EXEC_MD,B.PROFITABILITY_SENT_FILT_EXEC_MD,B.PROFITABILITY_SENT_REL_FILT_EXEC_MD,B.PROFITABILITY_SENT_WEIGHT_FILT_EXEC_MD,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_EXEC_MD,B.PROFITABILITY_NET_SENT_FILT_EXEC_MD,B.OPERATING_INCOME_REL_FILT_EXEC_MD,B.OPERATING_INCOME_SENT_FILT_EXEC_MD,B.OPERATING_INCOME_SENT_REL_FILT_EXEC_MD,B.OPERATING_INCOME_SENT_WEIGHT_FILT_EXEC_MD,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_EXEC_MD,B.OPERATING_INCOME_NET_SENT_FILT_EXEC_MD,B.CASH_FLOWS_REL_FILT_EXEC_MD,B.CASH_FLOWS_SENT_FILT_EXEC_MD,B.CASH_FLOWS_SENT_REL_FILT_EXEC_MD,B.CASH_FLOWS_SENT_WEIGHT_FILT_EXEC_MD,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_EXEC_MD,B.CASH_FLOWS_NET_SENT_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_REL_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_SENT_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_EXEC_MD,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_EXEC_MD,B.CAPITAL_USAGE_REL_FILT_EXEC_MD,B.CAPITAL_USAGE_SENT_FILT_EXEC_MD,B.CAPITAL_USAGE_SENT_REL_FILT_EXEC_MD,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_EXEC_MD,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_EXEC_MD,B.CAPITAL_USAGE_NET_SENT_FILT_EXEC_MD,B.GUIDANCE_REL_FILT_EXEC_MD,B.GUIDANCE_SENT_FILT_EXEC_MD,B.GUIDANCE_SENT_REL_FILT_EXEC_MD,B.GUIDANCE_SENT_WEIGHT_FILT_EXEC_MD,B.GUIDANCE_SENT_WEIGHT_REL_FILT_EXEC_MD,B.GUIDANCE_NET_SENT_FILT_EXEC_MD,B.SENT_FILT_EXEC_QA,B.NET_SENT_FILT_EXEC_QA,B.REVENUE_REL_FILT_EXEC_QA,B.REVENUE_SENT_FILT_EXEC_QA,B.REVENUE_SENT_REL_FILT_EXEC_QA,B.REVENUE_SENT_WEIGHT_FILT_EXEC_QA,B.REVENUE_SENT_WEIGHT_REL_FILT_EXEC_QA,B.REVENUE_NET_SENT_FILT_EXEC_QA,B.EARNINGS_REL_FILT_EXEC_QA,B.EARNINGS_SENT_FILT_EXEC_QA,B.EARNINGS_SENT_REL_FILT_EXEC_QA,B.EARNINGS_SENT_WEIGHT_FILT_EXEC_QA,B.EARNINGS_SENT_WEIGHT_REL_FILT_EXEC_QA,B.EARNINGS_NET_SENT_FILT_EXEC_QA,B.PROFITABILITY_REL_FILT_EXEC_QA,B.PROFITABILITY_SENT_FILT_EXEC_QA,B.PROFITABILITY_SENT_REL_FILT_EXEC_QA,B.PROFITABILITY_SENT_WEIGHT_FILT_EXEC_QA,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_EXEC_QA,B.PROFITABILITY_NET_SENT_FILT_EXEC_QA,B.OPERATING_INCOME_REL_FILT_EXEC_QA,B.OPERATING_INCOME_SENT_FILT_EXEC_QA,B.OPERATING_INCOME_SENT_REL_FILT_EXEC_QA,B.OPERATING_INCOME_SENT_WEIGHT_FILT_EXEC_QA,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_EXEC_QA,B.OPERATING_INCOME_NET_SENT_FILT_EXEC_QA,B.CASH_FLOWS_REL_FILT_EXEC_QA,B.CASH_FLOWS_SENT_FILT_EXEC_QA,B.CASH_FLOWS_SENT_REL_FILT_EXEC_QA,B.CASH_FLOWS_SENT_WEIGHT_FILT_EXEC_QA,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_EXEC_QA,B.CASH_FLOWS_NET_SENT_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_REL_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_SENT_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_EXEC_QA,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_EXEC_QA,B.CAPITAL_USAGE_REL_FILT_EXEC_QA,B.CAPITAL_USAGE_SENT_FILT_EXEC_QA,B.CAPITAL_USAGE_SENT_REL_FILT_EXEC_QA,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_EXEC_QA,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_EXEC_QA,B.CAPITAL_USAGE_NET_SENT_FILT_EXEC_QA,B.GUIDANCE_REL_FILT_EXEC_QA,B.GUIDANCE_SENT_FILT_EXEC_QA,B.GUIDANCE_SENT_REL_FILT_EXEC_QA,B.GUIDANCE_SENT_WEIGHT_FILT_EXEC_QA,B.GUIDANCE_SENT_WEIGHT_REL_FILT_EXEC_QA,B.GUIDANCE_NET_SENT_FILT_EXEC_QA,B.SENT_FILT_ANL_QA,B.NET_SENT_FILT_ANL_QA,B.REVENUE_REL_FILT_ANL_QA,B.REVENUE_SENT_FILT_ANL_QA,B.REVENUE_SENT_REL_FILT_ANL_QA,B.REVENUE_SENT_WEIGHT_FILT_ANL_QA,B.REVENUE_SENT_WEIGHT_REL_FILT_ANL_QA,B.REVENUE_NET_SENT_FILT_ANL_QA,B.EARNINGS_REL_FILT_ANL_QA,B.EARNINGS_SENT_FILT_ANL_QA,B.EARNINGS_SENT_REL_FILT_ANL_QA,B.EARNINGS_SENT_WEIGHT_FILT_ANL_QA,B.EARNINGS_SENT_WEIGHT_REL_FILT_ANL_QA,B.EARNINGS_NET_SENT_FILT_ANL_QA,B.PROFITABILITY_REL_FILT_ANL_QA,B.PROFITABILITY_SENT_FILT_ANL_QA,B.PROFITABILITY_SENT_REL_FILT_ANL_QA,B.PROFITABILITY_SENT_WEIGHT_FILT_ANL_QA,B.PROFITABILITY_SENT_WEIGHT_REL_FILT_ANL_QA,B.PROFITABILITY_NET_SENT_FILT_ANL_QA,B.OPERATING_INCOME_REL_FILT_ANL_QA,B.OPERATING_INCOME_SENT_FILT_ANL_QA,B.OPERATING_INCOME_SENT_REL_FILT_ANL_QA,B.OPERATING_INCOME_SENT_WEIGHT_FILT_ANL_QA,B.OPERATING_INCOME_SENT_WEIGHT_REL_FILT_ANL_QA,B.OPERATING_INCOME_NET_SENT_FILT_ANL_QA,B.CASH_FLOWS_REL_FILT_ANL_QA,B.CASH_FLOWS_SENT_FILT_ANL_QA,B.CASH_FLOWS_SENT_REL_FILT_ANL_QA,B.CASH_FLOWS_SENT_WEIGHT_FILT_ANL_QA,B.CASH_FLOWS_SENT_WEIGHT_REL_FILT_ANL_QA,B.CASH_FLOWS_NET_SENT_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_REL_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_SENT_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_SENT_REL_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_SENT_WEIGHT_REL_FILT_ANL_QA,B.SHAREHOLDER_RETURNS_NET_SENT_FILT_ANL_QA,B.CAPITAL_USAGE_REL_FILT_ANL_QA,B.CAPITAL_USAGE_SENT_FILT_ANL_QA,B.CAPITAL_USAGE_SENT_REL_FILT_ANL_QA,B.CAPITAL_USAGE_SENT_WEIGHT_FILT_ANL_QA,B.CAPITAL_USAGE_SENT_WEIGHT_REL_FILT_ANL_QA,B.CAPITAL_USAGE_NET_SENT_FILT_ANL_QA,B.GUIDANCE_REL_FILT_ANL_QA,B.GUIDANCE_SENT_FILT_ANL_QA,B.GUIDANCE_SENT_REL_FILT_ANL_QA,B.GUIDANCE_SENT_WEIGHT_FILT_ANL_QA,B.GUIDANCE_SENT_WEIGHT_REL_FILT_ANL_QA,B.GUIDANCE_NET_SENT_FILT_ANL_QA) """.format(config.schema,config.CT_sentiment_historical_table,config.schema,config.CT_sentiment_daily_table)
merge_flag=new_sf.truncate_or_merge_table(merge_query)

# COMMAND ----------

# DBTITLE 1,Write combined scores to sentiment parquet file.
#SAVE UPDATED NLP OBJECT FOR FUTURE REFERENCE
CT_sentiment_file = open(config.CT_sentiment_parquet_file, "wb")
CT_sentiment_file.close()
final_df.to_parquet(config.CT_sentiment_parquet_file,engine = 'pyarrow', compression = 'gzip')

